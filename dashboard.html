<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1500.0.min.js"></script>
</head>
<body class="p-8 bg-white font-sans">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-black text-slate-900 mb-8 tracking-tight">Library Stats</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
            <div class="bg-slate-50 p-8 rounded-[2rem] border border-slate-100">
                <p class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-2">Total Books</p>
                <h3 id="total-books" class="text-5xl font-black text-slate-900">0</h3>
            </div>
            <div class="bg-indigo-600 p-8 rounded-[2rem] text-white shadow-xl shadow-indigo-100">
                <p class="text-indigo-200 text-[10px] font-black uppercase tracking-widest mb-2">Active Loans</p>
                <h3 id="active-loans" class="text-5xl font-black">0</h3>
            </div>
        </div>
        <div class="bg-slate-50 p-6 rounded-[2.5rem] border border-slate-100">
            <h2 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-6">Recent S3 History</h2>
            <div id="recent-log" class="space-y-2 text-xs font-medium text-slate-600">Loading activity...</div>
        </div>
    </div>
    <script>
        AWS.config.update({ accessKeyId: 'AKIAWFH3BVHOQPMLKDQF', secretAccessKey: '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', region: 'us-east-1' });
        const s3 = new AWS.S3();
        const DATA_BUCKET = 'libishelf-storage';

        async function init() {
            try {
                const books = await s3.listObjectsV2({ Bucket: DATA_BUCKET, Prefix: 'books/' }).promise();
                const loans = await s3.listObjectsV2({ Bucket: DATA_BUCKET, Prefix: 'loans/' }).promise();
                document.getElementById('total-books').innerText = Math.max(0, books.Contents.length - 1);
                document.getElementById('active-loans').innerText = Math.max(0, loans.Contents.length - 1);
                document.getElementById('recent-log').innerText = "Last sync: " + new Date().toLocaleTimeString();
            } catch (e) { document.getElementById('recent-log').innerText = "Sync Error: Check Keys"; }
        }
        window.onload = init;
    </script>
</body>
</html>
