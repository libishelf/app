<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LibiShelf - Library Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Container -->
    <div class="w-full max-w-md bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden fade-in">
        
        <!-- Header / Logo -->
        <div class="pt-8 pb-6 flex flex-col items-center border-b border-slate-50">
            <img src="logo.svg" alt="LibiShelf Logo" class="h-12 w-auto mb-2" onerror="this.src='https://placeholder.com/wp-content/uploads/2018/10/placeholder.com-logo1.png'; this.classList.add('opacity-20')">
            <h1 class="text-xl font-bold tracking-tight text-slate-800">LibiShelf</h1>
        </div>

        <div class="p-8">
            <!-- App State Manager -->
            <div id="auth-container">
                <!-- Content injected here via JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // State management for the multi-step form
        let currentState = 'signup-email'; // signup-email, signup-details, signup-books, signup-plans, success, login
        let userData = {
            email: '',
            schoolName: '',
            schoolAddress: '',
            password: '',
            bookCount: 0,
            selectedPlan: ''
        };

        const container = document.getElementById('auth-container');

        function render() {
            container.innerHTML = '';
            
            switch(currentState) {
                case 'signup-email':
                    container.innerHTML = `
                        <h2 class="text-lg font-semibold mb-4 text-center">Create your account</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">Email Address</label>
                                <input type="email" id="email" value="${userData.email}" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition" placeholder="you@school.edu">
                            </div>
                            <button onclick="handleEmailContinue()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 rounded-lg transition duration-200 text-sm">Continue</button>
                            <p class="text-center text-xs text-slate-500 mt-4">
                                Already have an account? <a href="#" onclick="setState('login')" class="text-blue-600 font-semibold hover:underline">Sign In</a>
                            </p>
                        </div>
                    `;
                    break;

                case 'signup-details':
                    container.innerHTML = `
                        <h2 class="text-lg font-semibold mb-4">School Details</h2>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">School Name</label>
                                <input type="text" id="schoolName" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">School Address</label>
                                <input type="text" id="schoolAddress" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">Password</label>
                                <input type="password" id="password" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">Confirm Password</label>
                                <input type="password" id="confirmPassword" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition text-sm">
                            </div>
                            <button onclick="handleDetailsContinue()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 rounded-lg transition mt-2 text-sm">Continue</button>
                        </div>
                    `;
                    break;

                case 'signup-books':
                    container.innerHTML = `
                        <h2 class="text-lg font-semibold mb-2 text-center">Library Size</h2>
                        <p class="text-xs text-slate-500 mb-6 text-center">This helps us recommend the best plan for your collection.</p>
                        <div class="space-y-4 text-center">
                            <label class="block text-xs font-medium text-slate-500 uppercase mb-1">Approximate number of books</label>
                            <input type="number" id="bookCount" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-center text-lg font-bold" placeholder="500">
                            <button onclick="handleBooksContinue()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 rounded-lg transition text-sm">Continue</button>
                        </div>
                    `;
                    break;

                case 'signup-plans':
                    const isOver5k = userData.bookCount > 5000;
                    container.innerHTML = `
                        <h2 class="text-lg font-semibold mb-4 text-center">Choose your plan</h2>
                        <div class="space-y-4">
                            <!-- Pro Plan -->
                            <div onclick="userData.selectedPlan='pro'; render();" class="cursor-pointer border-2 p-4 rounded-xl transition ${userData.selectedPlan === 'pro' ? 'border-blue-500 bg-blue-50' : 'border-slate-100'} ${!isOver5k ? 'scale-105 shadow-md ring-1 ring-blue-200' : 'opacity-80'}">
                                <div class="flex justify-between items-start mb-2">
                                    <h3 class="font-bold text-slate-800">Pro Plan</h3>
                                    <span class="text-blue-600 font-bold">$5.00<span class="text-xs text-slate-400">/mo</span></span>
                                </div>
                                <ul class="text-[11px] text-slate-600 space-y-1">
                                    <li>• Catalog up to 5,000 items</li>
                                    <li>• Offline mode access</li>
                                    <li>• All proofreading features</li>
                                    <li>• Library challenges included</li>
                                </ul>
                                ${!isOver5k ? '<div class="mt-2 text-[10px] bg-blue-600 text-white px-2 py-0.5 rounded inline-block">Recommended</div>' : ''}
                            </div>

                            <!-- Ultimate Plan -->
                            <div onclick="userData.selectedPlan='ultimate'; render();" class="cursor-pointer border-2 p-4 rounded-xl transition ${userData.selectedPlan === 'ultimate' ? 'border-blue-500 bg-blue-50' : 'border-slate-100'} ${isOver5k ? 'scale-105 shadow-md ring-1 ring-blue-200' : 'opacity-80'}">
                                <div class="flex justify-between items-start mb-2">
                                    <h3 class="font-bold text-slate-800">Ultimate Plan</h3>
                                    <span class="text-blue-600 font-bold">$10.00<span class="text-xs text-slate-400">/mo</span></span>
                                </div>
                                <ul class="text-[11px] text-slate-600 space-y-1">
                                    <li>• Everything in Pro</li>
                                    <li>• Catalog up to 100,000 items</li>
                                    <li>• Priority cloud syncing</li>
                                </ul>
                                ${isOver5k ? '<div class="mt-2 text-[10px] bg-blue-600 text-white px-2 py-0.5 rounded inline-block">Recommended</div>' : ''}
                            </div>

                            <button onclick="handlePlansContinue()" class="w-full bg-slate-900 hover:bg-black text-white font-medium py-2 rounded-lg transition mt-4 text-sm">Finish Setup</button>
                        </div>
                    `;
                    break;

                case 'success':
                    container.innerHTML = `
                        <div class="text-center py-6 fade-in">
                            <div class="bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                            </div>
                            <h2 class="text-xl font-bold mb-2">Success!</h2>
                            <p class="text-sm text-slate-500 mb-6">Your account has been created. Welcome to LibiShelf!</p>
                            <button onclick="setState('login')" class="w-full bg-blue-600 text-white py-2 rounded-lg text-sm font-medium">Log In Now</button>
                        </div>
                    `;
                    break;

                case 'login':
                    container.innerHTML = `
                        <h2 class="text-lg font-semibold mb-4 text-center">Sign In</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">Email</label>
                                <input type="email" id="loginEmail" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-slate-500 uppercase mb-1">Password</label>
                                <input type="password" id="loginPass" class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm">
                            </div>
                            <button onclick="handleLogin()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 rounded-lg transition text-sm">Sign In</button>
                            <p class="text-center text-xs text-slate-500 mt-4">
                                Need an account? <a href="#" onclick="setState('signup-email')" class="text-blue-600 font-semibold hover:underline">Sign Up</a>
                            </p>
                        </div>
                    `;
                    break;
            }
        }

        // Action Handlers
        function setState(s) { currentState = s; render(); }

        function handleEmailContinue() {
            userData.email = document.getElementById('email').value;
            if(!userData.email) return showMessage('Enter email');
            setState('signup-details');
        }

        function handleDetailsContinue() {
            userData.schoolName = document.getElementById('schoolName').value;
            userData.schoolAddress = document.getElementById('schoolAddress').value;
            userData.password = document.getElementById('password').value;
            const confirm = document.getElementById('confirmPassword').value;

            if(userData.password !== confirm) return showMessage("Passwords don't match");
            if(!userData.schoolName) return showMessage("School name required");
            
            setState('signup-books');
        }

        function handleBooksContinue() {
            const count = parseInt(document.getElementById('bookCount').value);
            if(isNaN(count)) return showMessage("Please enter a valid number");
            userData.bookCount = count;
            userData.selectedPlan = count > 5000 ? 'ultimate' : 'pro';
            setState('signup-plans');
        }

        function handlePlansContinue() {
            // Here is where you would call your AWS Lambda to SAVE to DynamoDB
            console.log("Saving user to LibiShelf:", userData);
            setState('success');
        }

        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const pass = document.getElementById('loginPass').value;
            // Here you would call Lambda to VERIFY credentials
            console.log("Logging in...", email);
            showMessage("Checking credentials...");
        }

        function showMessage(txt) {
            // Simple non-alert replacement
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 left-1/2 -translate-x-1/2 bg-slate-800 text-white px-4 py-2 rounded text-xs z-50';
            toast.innerText = txt;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // Initialize
        render();
    </script>
</body>
</html>
