<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S3 Library System</title>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1500.0.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card { @apply bg-white p-6 rounded-lg shadow-md border border-gray-200; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-8">
    <div class="max-w-2xl mx-auto">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Library Storage System</h1>
            <p class="text-gray-600">Syncing to AWS S3</p>
        </header>

        <!-- Configuration (Usually hidden or hardcoded) -->
        <div id="config-panel" class="card mb-6">
            <h2 class="text-lg font-semibold mb-4">AWS Credentials</h2>
            <div class="grid grid-cols-1 gap-4">
                <input id="accessKey" type="text" placeholder="Access Key ID" class="border p-2 rounded">
                <input id="secretKey" type="password" placeholder="Secret Access Key" class="border p-2 rounded">
                <input id="bucketName" type="text" placeholder="Bucket Name" class="border p-2 rounded">
                <button onclick="saveConfig()" class="bg-blue-600 text-white py-2 rounded hover:bg-blue-700">Initialize Connection</button>
            </div>
        </div>

        <!-- Library Form -->
        <div id="app-panel" class="card hidden">
            <h2 class="text-lg font-semibold mb-4">Add Book to Library</h2>
            <div class="flex flex-col gap-4">
                <input id="bookTitle" type="text" placeholder="Book Title" class="border p-2 rounded">
                <input id="bookAuthor" type="text" placeholder="Author" class="border p-2 rounded">
                <button onclick="uploadToS3()" class="bg-green-600 text-white py-2 rounded hover:bg-green-700">Save to S3</button>
            </div>
            <div id="status" class="mt-4 text-sm font-medium"></div>
        </div>
    </div>

    <script>
        let s3 = null;

        function saveConfig() {
            const accessKeyId = document.getElementById('accessKey').value;
            const secretAccessKey = document.getElementById('secretKey').value;
            const bucketName = document.getElementById('bucketName').value;

            AWS.config.update({
                accessKeyId: accessKeyId,
                secretAccessKey: secretAccessKey,
                region: 'us-east-1' // Change to your region
            });

            s3 = new AWS.S3({ params: { Bucket: bucketName }});
            
            document.getElementById('config-panel').classList.add('hidden');
            document.getElementById('app-panel').classList.remove('hidden');
        }

        async function uploadToS3() {
            const title = document.getElementById('bookTitle').value;
            const author = document.getElementById('bookAuthor').value;
            const status = document.getElementById('status');

            if (!title || !author) {
                status.innerText = "Please fill all fields";
                status.className = "mt-4 text-sm font-medium text-red-600";
                return;
            }

            const libraryData = {
                id: Date.now(),
                title: title,
                author: author,
                timestamp: new Date().toISOString()
            };

            const params = {
                Key: `books/book-${libraryData.id}.json`,
                Body: JSON.stringify(libraryData),
                ContentType: 'application/json'
            };

            status.innerText = "Uploading...";
            status.className = "mt-4 text-sm font-medium text-blue-600";

            try {
                await s3.putObject(params).promise();
                status.innerText = "Successfully saved to S3!";
                status.className = "mt-4 text-sm font-medium text-green-600";
                document.getElementById('bookTitle').value = '';
                document.getElementById('bookAuthor').value = '';
            } catch (err) {
                console.error(err);
                status.innerText = "Error: " + err.message;
                status.className = "mt-4 text-sm font-medium text-red-600";
            }
        }
    </script>
</body>
</html>
